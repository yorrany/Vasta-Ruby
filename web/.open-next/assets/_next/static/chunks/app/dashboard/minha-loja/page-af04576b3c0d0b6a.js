(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5504],{2850:(e,t,a)=>{Promise.resolve().then(a.bind(a,4065))},4065:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(5155),r=a(2115),l=a(4505),i=a(3473),o=a(7401);let d=(0,o.A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),n=(0,o.A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),c=(0,o.A)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var u=a(747),x=a(4912),m=a(767),v=a(2316);let p=(0,o.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var h=a(2509),f=a(4807),b=a(7780);function g(e){var t;let{isOpen:a,onClose:i,productToEdit:o,onSuccess:d}=e,[n,c]=(0,r.useState)((null==o?void 0:o.title)||""),[g,y]=(0,r.useState)((null==o?void 0:o.description)||""),[j,N]=(0,r.useState)((null==o?void 0:null===(t=o.price)||void 0===t?void 0:t.toString())||""),[w,k]=(0,r.useState)((null==o?void 0:o.image_url)||null),[A,S]=(0,r.useState)(!1),[E,C]=(0,r.useState)(!1),{user:_}=(0,x.A)(),z=(0,u.U)(),M=(0,r.useRef)(null),U=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a&&_){if(a.size>5242880){alert("Imagem deve ter no m\xe1ximo 5MB");return}C(!0);try{let e=a.name.split(".").pop(),t="".concat(_.id,"/products/").concat(Date.now(),".").concat(e),{error:s}=await z.storage.from("avatars").upload(t,a);if(s)throw s;let{data:{publicUrl:r}}=z.storage.from("avatars").getPublicUrl(t);k(r)}catch(e){console.error("Error uploading product image:",e),alert("Erro ao fazer upload da imagem.")}finally{C(!1)}}},P=async e=>{if(e.preventDefault(),!_)return;S(!0);let t=parseFloat(j.replace(",","."));try{let e={title:n,description:g,price:isNaN(t)?0:t,image_url:w,type:"digital",profile_id:_.id};if(null==o?void 0:o.id){let{error:t}=await z.from("products").update(e).eq("id",o.id);if(t)throw t}else{let{error:t}=await z.from("products").insert(e);if(t)throw t}d(),i()}catch(e){console.error("Error saving product:",e),alert("Erro ao salvar produto.")}finally{S(!1)}};return a?(0,s.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200 p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-lg bg-vasta-surface rounded-[2rem] border border-vasta-border shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-vasta-border",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-vasta-text",children:o?"Editar Produto":"Novo Produto Digital"}),(0,s.jsx)("button",{onClick:i,className:"text-vasta-muted hover:text-vasta-text transition-colors p-2 hover:bg-vasta-surface-soft rounded-full",children:(0,s.jsx)(m.A,{size:20})})]}),(0,s.jsxs)("form",{onSubmit:P,className:"p-6 space-y-6 max-h-[80vh] overflow-y-auto custom-scrollbar",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{onClick:()=>{var e;return null===(e=M.current)||void 0===e?void 0:e.click()},className:"relative group cursor-pointer w-full h-48 rounded-2xl bg-vasta-surface-soft border-2 border-dashed border-vasta-border hover:border-vasta-primary/50 transition-all flex flex-col items-center justify-center overflow-hidden",children:[w?(0,s.jsx)("img",{src:w,alt:"Product",className:"w-full h-full object-cover"}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 text-vasta-muted group-hover:text-vasta-primary transition-colors",children:[(0,s.jsx)("div",{className:"p-3 bg-vasta-bg rounded-full shadow-sm",children:(0,s.jsx)(v.A,{size:24})}),(0,s.jsx)("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Adicionar Capa"})]}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center text-white font-bold backdrop-blur-[1px]",children:E?(0,s.jsx)(l.A,{className:"animate-spin"}):(0,s.jsx)(p,{size:20})}),(0,s.jsx)("input",{type:"file",ref:M,className:"hidden",accept:"image/*",onChange:U})]})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-vasta-muted uppercase tracking-wider mb-2",children:"Nome do Produto"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-vasta-muted",size:16}),(0,s.jsx)("input",{required:!0,value:n,onChange:e=>c(e.target.value),placeholder:"Ex: E-book de Receitas",className:"w-full rounded-xl bg-vasta-surface-soft border border-vasta-border py-3 pl-10 pr-4 text-sm font-medium text-vasta-text focus:border-vasta-primary focus:ring-1 focus:ring-vasta-primary outline-none transition-all"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-vasta-muted uppercase tracking-wider mb-2",children:"Pre\xe7o (R$)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(f.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-vasta-muted",size:16}),(0,s.jsx)("input",{type:"number",step:"0.01",min:"0",required:!0,value:j,onChange:e=>N(e.target.value),placeholder:"29.90",className:"w-full rounded-xl bg-vasta-surface-soft border border-vasta-border py-3 pl-10 pr-4 text-sm font-medium text-vasta-text focus:border-vasta-primary focus:ring-1 focus:ring-vasta-primary outline-none transition-all"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold text-vasta-muted uppercase tracking-wider mb-2",children:"Descri\xe7\xe3o"}),(0,s.jsx)("textarea",{value:g,onChange:e=>y(e.target.value),placeholder:"Detalhes incr\xedveis sobre seu produto...",rows:4,className:"w-full rounded-xl bg-vasta-surface-soft border border-vasta-border p-4 text-sm font-medium text-vasta-text focus:border-vasta-primary focus:ring-1 focus:ring-vasta-primary outline-none transition-all resize-none"})]})]}),(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)("button",{type:"submit",disabled:A||E,className:"w-full flex items-center justify-center gap-2 rounded-xl bg-vasta-primary py-4 text-sm font-bold text-white shadow-lg shadow-vasta-primary/20 hover:bg-vasta-primary-soft hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:scale-100",children:A?(0,s.jsx)(l.A,{className:"animate-spin"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.A,{size:18})," Salvar Produto"]})})})]})]})}):null}function y(){let{user:e}=(0,x.A)(),t=(0,u.U)(),[a,o]=(0,r.useState)([]),[m,v]=(0,r.useState)(!0),[p,h]=(0,r.useState)(!1),[f,b]=(0,r.useState)(null),y=async()=>{if(!e)return;let{data:a}=await t.from("products").select("*").eq("profile_id",e.id).order("created_at",{ascending:!1});a&&o(a),v(!1)};(0,r.useEffect)(()=>{y()},[e]);let j=()=>{b(null),h(!0)},N=e=>{b(e),h(!0)};return m?(0,s.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,s.jsx)(l.A,{className:"animate-spin text-vasta-primary"})}):(0,s.jsxs)("div",{className:"space-y-8 pb-32 animate-in fade-in duration-500",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-vasta-text",children:"Minha Loja"}),(0,s.jsx)("p",{className:"text-sm text-vasta-muted",children:"Gerencie seus produtos digitais e servi\xe7os"})]}),(0,s.jsxs)("button",{onClick:j,className:"flex items-center justify-center gap-2 rounded-2xl bg-vasta-primary px-6 py-3 text-sm font-bold text-white transition-all hover:bg-vasta-primary-soft shadow-lg shadow-vasta-primary/20 hover:scale-105 active:scale-95",children:[(0,s.jsx)(i.A,{size:18})," Novo Produto"]})]}),(0,s.jsxs)("section",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-[2rem] border border-emerald-500/20 bg-emerald-500/5 p-6 relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 p-8 opacity-10",children:(0,s.jsx)(d,{size:100,className:"text-emerald-500"})}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full bg-emerald-500/10 px-3 py-1 text-xs font-bold text-emerald-500 mb-2 border border-emerald-500/20",children:[(0,s.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,s.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),(0,s.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),"Checkout Ativo"]}),(0,s.jsx)("h3",{className:"text-lg font-bold text-vasta-text",children:"Voc\xea est\xe1 pronto para vender!"}),(0,s.jsx)("p",{className:"text-sm text-vasta-muted mt-1 max-w-md",children:"Seus produtos aparecer\xe3o automaticamente no seu perfil p\xfablico e os pagamentos cair\xe3o direto na sua conta Stripe conectada."})]})]}),0===a.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-[2.5rem] border border-dashed border-vasta-border py-24 text-center bg-vasta-surface/30",children:[(0,s.jsx)("div",{className:"h-20 w-20 rounded-3xl bg-vasta-surface-soft flex items-center justify-center mb-6 text-vasta-muted shadow-sm",children:(0,s.jsx)(d,{size:40})}),(0,s.jsx)("h3",{className:"text-xl font-bold text-vasta-text mb-2",children:"Sua loja est\xe1 vazia"}),(0,s.jsx)("p",{className:"text-vasta-muted max-w-xs mx-auto mb-8 leading-relaxed",children:"Comece a monetizar sua audi\xeancia vendendo e-books, consultorias ou presets."}),(0,s.jsx)("button",{onClick:j,className:"text-sm font-bold text-vasta-primary hover:underline underline-offset-4",children:"Criar primeiro produto"})]}):(0,s.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:a.map(e=>(0,s.jsxs)("div",{className:"group flex flex-col rounded-[2rem] border border-vasta-border bg-vasta-surface overflow-hidden hover:shadow-xl hover:shadow-black/5 hover:border-vasta-primary/30 transition-all duration-300",children:[(0,s.jsxs)("div",{className:"h-48 bg-vasta-surface-soft relative overflow-hidden",children:[e.image_url?(0,s.jsx)("img",{src:e.image_url,alt:e.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-vasta-bg/50",children:(0,s.jsx)(d,{className:"text-vasta-muted/30",size:40})}),(0,s.jsx)("div",{className:"absolute top-4 right-4",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full bg-black/60 backdrop-blur-md text-[10px] font-bold text-white uppercase tracking-wider border border-white/10",children:e.type})})]}),(0,s.jsxs)("div",{className:"p-5 flex-1 flex flex-col",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,s.jsx)("h3",{className:"text-base font-bold text-vasta-text leading-tight line-clamp-2",children:e.title})}),(0,s.jsx)("p",{className:"text-sm font-bold text-vasta-primary mb-4",children:e.price>0?"R$ ".concat(e.price.toFixed(2).replace(".",",")):"Gr\xe1tis"}),(0,s.jsxs)("div",{className:"mt-auto flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>N(e),className:"flex-1 flex items-center justify-center gap-2 rounded-xl bg-vasta-surface-soft border border-vasta-border py-2.5 text-xs font-bold text-vasta-text hover:bg-vasta-border/50 transition-colors",children:[(0,s.jsx)(n,{size:14})," Editar"]}),(0,s.jsx)("button",{className:"flex items-center justify-center p-2.5 rounded-xl bg-vasta-surface-soft border border-vasta-border text-vasta-muted hover:text-vasta-text hover:bg-vasta-border/50 transition-colors",children:(0,s.jsx)(c,{size:16})})]})]})]},e.id))})]}),(0,s.jsx)(g,{isOpen:p,onClose:()=>h(!1),productToEdit:f,onSuccess:y})]})}},4912:(e,t,a)=>{"use strict";a.d(t,{A:()=>d,AuthProvider:()=>o});var s=a(5155),r=a(2115),l=a(747);let i=(0,r.createContext)(void 0);function o(e){let{children:t}=e,[a,o]=(0,r.useState)(!1),[d,n]=(0,r.useState)("signup"),[c,u]=(0,r.useState)(void 0),[x,m]=(0,r.useState)(null),[v,p]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=(0,l.U)();e.auth.getUser().then(e=>{let{data:{user:t}}=e;m(t),p(!1)});let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{var a;m(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),p(!1)});return()=>{t.unsubscribe()}},[]),(0,s.jsx)(i.Provider,{value:{openAuthModal:(e,t)=>{n(e),u(t),o(!0)},closeAuthModal:()=>o(!1),isOpen:a,mode:d,contextualCTA:c,user:x,loading:v},children:t})}function d(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},747:(e,t,a)=>{"use strict";let s;a.d(t,{U:()=>n});var r=a(5352),l=a(2818);let i=l.env.NEXT_PUBLIC_SUPABASE_URL,o=l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,d=()=>{if(!i||!o)throw Error("[Security] Missing Supabase environment variables. Ensure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY are set.")};function n(){return s||(d(),s=(0,r.UU)(i||"https://placeholder.supabase.co",o||"placeholder-key",{auth:{persistSession:!0,storageKey:"vasta-auth-token",storage:window.localStorage,detectSessionInUrl:!1,flowType:"pkce",autoRefreshToken:!0}}))}},7401:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var s=a(2115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:x,...m}=e;return(0,s.createElement)("svg",{ref:t,...n,width:r,height:r,stroke:a,strokeWidth:i?24*Number(l)/Number(r):l,className:o("lucide",c),...!u&&!d(m)&&{"aria-hidden":"true"},...m},[...x.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,s.forwardRef)((a,l)=>{let{className:d,...n}=a;return(0,s.createElement)(c,{ref:l,iconNode:t,className:o("lucide-".concat(r(i(e))),"lucide-".concat(e),d),...n})});return a.displayName=i(e),a}},4807:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},2316:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},4505:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3473:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7780:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2509:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]])},767:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(7401).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[5352,8441,1517,7358],()=>t(2850)),_N_E=e.O()}]);